<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WEB SYNTH</title>
    <link rel="stylesheet" href="src/css/knob.css">
    <link rel="stylesheet" href="src/css/styles.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Anta">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>

<body>
    <div class="body-outer" id="app">
        <div class="separator top-body">
            <div class="body-inner logo">

            </div>
            <div class="body-inner select-control">

            </div>
            <div class="body-inner volume-control">

            </div>
        </div>




        <div class="separator mid-body">
            <!-- ----------sub and noise----------- -->
            <div class="mid-extra">

                <!-- ----------SUB----------- -->
                <div class="body-inner" id="osc-sub">
                    <div class="title">
                        <input class="title-checkbox" type="checkbox" checked>
                        <span class="title-text">SUB</span>
                    </div>
                </div>

                <!-- ----------NOISE----------- -->
                <div class="body-inner" id="osc-noise">
                    <div class="title">
                        <input class="title-checkbox" type="checkbox" checked>
                        <span class="title-text">NOISE</span>
                    </div>
                </div>
            </div>



            <!-- ----------OSC AAAAAAAAAAAAAAAAAA----------- -->
            <div class="body-inner" id="osc-main" data-id="A">
                <div class="title">
                    <input class="title-checkbox" id="checkbox-osc-A" type="checkbox" checked
                        @click="osc.A.onOff = !osc.A.onOff">
                    <span class="title-text">OSC A</span>
                </div>
                <div class="wavetable-body">
                    <canvas class="wavetable" id="wavetable-canvas-A"></canvas>
                    <div class="wavetable-selection" id="wavetable-selection-A"></div>
                </div>
                <div class="knobs-background">
                    <div class="knobs-row" @mouseUp="unselectKnobs">
                        <!-- ----------OSC A - UNISON ----------- -->
                        <div class="rela-inline knob">
                            <div class="rela-block">
                                <div class="knob-updown-body">
                                    <div class="knob-updown-text" :style="{'color':osc.A.onOff?'white':'#888'}"
                                        @mouseDown="knobs[10].selected = true; app.currentY = event.pageY; event.preventDefault()">
                                        {{knobs[10].value.cur}}</div>
                                    <div class="knob-updown-button-body">
                                        <div class="knob-updown-button" :style="{'color':osc.A.onOff?'white':'#888'}"
                                            @click="updownCounter(knobs[10].value, 1);">
                                            <div style="transform: translateY(-4px);">▲</div>
                                        </div>
                                        <div class="knob-updown-button" :style="{'color':osc.A.onOff?'white':'#888'}"
                                            @click="updownCounter(knobs[10].value, -1);">
                                            <div style="transform: translateY(-3px);">▼</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="rela-block knob-label" :style="{'color':osc.A.onOff?'#E4E8EA':'#888'}">
                                {{knobs[10].label}}</div>
                        </div>

                        <!-- ----------OSC A - DETUNE / BLEND / PITCH ----------- -->
                        <div v-for="knob in [knobs[11],knobs[12],knobs[13]]" class="rela-inline knob style3"
                            @drop="knob.env.target = selectedDragItem;" @dragover.prevent @dragenter.prevent>


                            <div v-if="knob.env.target!=-1" class="knob-active-light"
                                :style="{'background-color': knob.env.target==curENV?'white':'#888'}"></div>

                            <div class="rela-block knob-dial" :style="{'color':osc.A.onOff?knob.color:'#888'}">
                                <div class="abs-center dial-grip"
                                    :style="{'transform': 'translate(-50%,-50%) rotate('+knob.rotation+'deg)'}"
                                    @mouseDown="knob.selected = true; app.currentY = event.pageY; event.preventDefault()">
                                </div>

                                <svg class="dial-svg" viewBox="0 0 100 100">

                                    <!-- ----------KNOB OUTER ENV ----------- -->
                                    <path v-if="knob.env.target==curENV" d="M18,80 A 44 44 0 1 1 82 80" fill="none"
                                        stroke="white" style="stroke-dasharray: 205 205;"
                                        :style="{'stroke-dashoffset':205 - 205*((knob.env.rotation*1 + 132)/264)}" />

                                    <path d="M20,76 A 40 40 0 1 1 80 76" fill="none" stroke="#55595C" />

                                    <path d="M20,76 A 40 40 0 1 1 80 76" fill="none"
                                        :stroke="osc.A.onOff?knob.color:'#888'"
                                        :style="{'stroke-dashoffset':184 - 184*((knob.rotation*1 + 132)/264)}" />
                                </svg>
                            </div>

                            <div class="rela-block knob-label" :style="{'color':osc.A.onOff?'#E4E8EA':'#888'}">
                                {{knob.label}}</div>

                            <div class="knob-hover-text" v-if="knob.selected">{{knob.value.cur}}</div>
                        </div>
                    </div>
                    <div class="knobs-row">
                        <!-- ----------OSC A - VOLUME ----------- -->
                        <div v-for="knob in [knobs[14]]" class="rela-inline knob style3"
                            @drop="knob.env.target = selectedDragItem;" @dragover.prevent @dragenter.prevent>


                            <div v-if="knob.env.target!=-1" class="knob-active-light"
                                :style="{'background-color': knob.env.target==curENV?'white':'#888'}"></div>


                            <div class="rela-block knob-dial" :style="{'color':osc.A.onOff?knob.color:'#888'}">
                                <div class="abs-center dial-grip"
                                    :style="{'transform': 'translate(-50%,-50%) rotate('+knob.rotation+'deg)'}"
                                    @mouseDown="knob.selected = true; app.currentY = event.pageY; event.preventDefault()">
                                </div>
                                <svg class="dial-svg" viewBox="0 0 100 100">
                                    <!-- ----------KNOB OUTER ENV ----------- -->
                                    <path v-if="knob.env.target==curENV" d="M18,80 A 44 44 0 1 1 82 80" fill="none"
                                        stroke="white" style="stroke-dasharray: 205 205;"
                                        :style="{'stroke-dashoffset':205 - 205*((knob.env.rotation*1 + 132)/264)}" />


                                    <path d="M20,76 A 40 40 0 1 1 80 76" fill="none" stroke="#55595C" />
                                    <path d="M20,76 A 40 40 0 1 1 80 76" fill="none"
                                        :stroke="osc.A.onOff?knob.color:'#888'"
                                        :style="{'stroke-dashoffset':184 - 184*((knob.rotation*1 + 132)/264)}" />
                                </svg>
                            </div>

                            <div class="rela-block knob-label" :style="{'color':osc.A.onOff?'#E4E8EA':'#888'}">
                                {{knob.label}}</div>

                            <div class="knob-hover-text" v-if="knob.selected">{{knob.value.cur}}</div>
                        </div>
                    </div>
                </div>
            </div>



            <!-- ----------OSC BBBBBBBBBBBBBBBBBBBBBBBB----------- -->
            <div class="body-inner" id="osc-main" data-id="B">

                <!-- ----------title ----------- -->
                <div class="title">
                    <input class="title-checkbox" id="checkbox-osc-B" type="checkbox"
                        @click="osc.B.onOff = !osc.B.onOff">
                    <span class="title-text">OSC B</span>
                </div>

                <!-- ----------wavetable----------- -->
                <div class="wavetable-body">
                    <canvas class="wavetable" id="wavetable-canvas-B"></canvas>
                    <div class="wavetable-selection" id="wavetable-selection-B"></div>
                </div>

                <!-- ----------knobs----------- -->
                <div class="knobs-background">

                    <!-- ----------upper knobs----------- -->
                    <div class="knobs-row" @mouseUp="unselectKnobs">
                        <div class="rela-inline knob">
                            <div class="rela-block">
                                <div class="knob-updown-body">
                                    <div class="knob-updown-text" :style="{'color':osc.B.onOff?'white':'#888'}"
                                        @mouseDown="knobs[0].selected = true; app.currentY = event.pageY; event.preventDefault()">
                                        {{knobs[0].value.cur}}</div>
                                    <div class="knob-updown-button-body">
                                        <div class="knob-updown-button" :style="{'color':osc.B.onOff?'white':'#888'}"
                                            @click="updownCounter(knobs[0].value, 1);">
                                            <div style="transform: translateY(-4px);">▲</div>
                                        </div>
                                        <div class="knob-updown-button" :style="{'color':osc.B.onOff?'white':'#888'}"
                                            @click="updownCounter(knobs[0].value, -1);">
                                            <div style="transform: translateY(-3px);">▼</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="rela-block knob-label" :style="{'color':knobs[0].active?'#E4E8EA':'#888'}">
                                {{knobs[0].label}}</div>
                        </div>

                        <div v-for="knob in [knobs[1],knobs[2],knobs[3]]" class="rela-inline knob style3">
                            <div class="rela-block knob-dial" :style="{'color':osc.B.onOff?knob.color:'#888'}">
                                <div class="abs-center dial-grip"
                                    :style="{'transform': 'translate(-50%,-50%) rotate('+knob.rotation+'deg)'}"
                                    @mouseDown="knob.selected = true; app.currentY = event.pageY; event.preventDefault()">
                                </div>
                                <svg class="dial-svg" viewBox="0 0 100 100">
                                    <path d="M18,80 A 44 44 0 1 1 82 80" fill="none" stroke="white"
                                        style="stroke-dasharray: 205 205;"
                                        :style="{'stroke-dashoffset':205 - 205*((knob.rotation*1 + 132)/264)}" />
                                    <path d="M20,76 A 40 40 0 1 1 80 76" fill="none" stroke="#55595C" />
                                    <path d="M20,76 A 40 40 0 1 1 80 76" fill="none"
                                        :stroke="osc.B.onOff?knob.color:'#888'"
                                        :style="{'stroke-dashoffset':184 - 184*((knob.rotation*1 + 132)/264)}" />
                                </svg>
                            </div>
                            <div class="rela-block knob-label" :style="{'color':osc.B.onOff?'#E4E8EA':'#888'}">
                                {{knob.label}}</div>
                            <div class="knob-hover-text" v-if="knob.selected">{{knob.value.cur}}</div>
                        </div>
                    </div>

                    <!-- ----------lower knobs----------- -->
                    <div class="knobs-row">
                        <div v-for="knob in [knobs[4]]" class="rela-inline knob style3">
                            <div class="rela-block knob-dial" :style="{'color':osc.B.onOff?knob.color:'#888'}">
                                <div class="abs-center dial-grip"
                                    :style="{'transform': 'translate(-50%,-50%) rotate('+knob.rotation+'deg)'}"
                                    @mouseDown="knob.selected = true; app.currentY = event.pageY; event.preventDefault()">
                                </div>
                                <svg class="dial-svg" viewBox="0 0 100 100">
                                    <path d="M20,76 A 40 40 0 1 1 80 76" fill="none" stroke="#55595C" />
                                    <path d="M20,76 A 40 40 0 1 1 80 76" fill="none"
                                        :stroke="osc.B.onOff?knob.color:'#888'"
                                        :style="{'stroke-dashoffset':184 - 184*((knob.rotation*1 + 132)/264)}" />
                                </svg>
                            </div>
                            <div class="rela-block knob-label" :style="{'color':osc.B.onOff?'#E4E8EA':'#888'}">
                                {{knob.label}}</div>
                            <div class="knob-hover-text" v-if="knob.selected">{{knob.value.cur}}</div>
                        </div>
                    </div>
                </div>
            </div>



            <!-- ----------------------FILTER---------------------- -->
            <div class="body-inner filter-body">
                <div class="title">
                    <input class="title-checkbox" type="checkbox" checked>
                    <span class="title-text">FILTER</span>
                </div>
            </div>
        </div>




        <div class="separator bot-body">
            <!-- ----------------------ENV---------------------- -->
            <div class="body-inner ENV-body">

                <!-- ----------------------ENV select---------------------- -->
                <div class="ENV-select-body">
                    <div class="ENV-select-box" draggable="true" @mouseDown="curENV = 0;setENVknobRotation();">
                        <span class="ENV-select-text" :style="{'color':curENV==0?'white':'#888'}">ENV 1</span>
                        <span class="material-symbols-outlined"
                            :style="{'color':curENV==0?'white':'#888'}">open_with</span>
                    </div>
                    <div class="ENV-select-box" draggable="true" @mouseDown="curENV = 1;setENVknobRotation();"
                        style="border-left: 1px solid white; border-right: 1px solid white; ">
                        <span class="ENV-select-text" :style="{'color':curENV==1?'white':'#888'}">ENV 2</span>
                        <span class="material-symbols-outlined"
                            :style="{'color':curENV==1?'white':'#888'}">open_with</span>
                    </div>
                    <div class="ENV-select-box" draggable="true" @mouseDown="curENV = 2;setENVknobRotation();">
                        <span class="ENV-select-text" :style="{'color':curENV==2?'white':'#888'}">ENV 3</span>
                        <span class="material-symbols-outlined"
                            :style="{'color':curENV==2?'white':'#888'}">open_with</span>
                    </div>
                </div>

                <!-- ----------------------ENV canvas---------------------- -->
                <div class="ENV-canvas-body">
                    <canvas id="ENV-canvas" width="600" height="300"></canvas>

                </div>

                <!-- ----------------------ENV knobs---------------------- -->
                <div class="ENV-knobs-body">
                    <div v-for="knob in [knobs[60],knobs[61],knobs[62],knobs[63]]" class="rela-inline knob style3">
                        <div class="rela-block knob-dial" :style="{'color':knob.color}">
                            <div class="abs-center dial-grip"
                                :style="{'transform': 'translate(-50%,-50%) rotate('+knob.rotation+'deg)'}"
                                @mouseDown="knob.selected = true; app.currentY = event.pageY; event.preventDefault()">
                            </div>
                            <svg class="dial-svg" viewBox="0 0 100 100">
                                <path d="M20,76 A 40 40 0 1 1 80 76" fill="none" stroke="#55595C" />
                                <path d="M20,76 A 40 40 0 1 1 80 76" fill="none" :stroke="knob.color"
                                    :style="{'stroke-dashoffset':184 - 184*((knob.rotation*1 + 132)/264)}" />
                            </svg>
                        </div>
                        <div class="rela-block knob-label" :style="{'color':'#E4E8EA'}">
                            {{knob.label}}</div>
                        <div class="knob-hover-text" v-if="knob.selected">{{knob.value.cur}}</div>
                    </div>
                </div>
            </div>


            <!-- ----------------------LFO---------------------- -->
            <div class="body-inner LFO-body">

            </div>


            <!-- ----------------------EXTRA---------------------- -->
            <div class="body-inner bot-extra">

            </div>
        </div>

        <div class="piano-body">
            <div class="wrapper">
                <header>
                    <div class="column keys-checkbox">
                        <input type="checkbox" checked>
                        <span>Show Keys</span>
                    </div>
                </header>
                <ul class="piano-keys">
                    <li class="key white" data-key="a"><span>a</span></li>
                    <li class="key black" data-key="w"><span>w</span></li>
                    <li class="key white" data-key="s"><span>s</span></li>
                    <li class="key black" data-key="e"><span>e</span></li>
                    <li class="key white" data-key="d"><span>d</span></li>
                    <li class="key white" data-key="f"><span>f</span></li>
                    <li class="key black" data-key="t"><span>t</span></li>
                    <li class="key white" data-key="g"><span>g</span></li>
                    <li class="key black" data-key="y"><span>y</span></li>
                    <li class="key white" data-key="h"><span>h</span></li>
                    <li class="key black" data-key="u"><span>u</span></li>
                    <li class="key white" data-key="j"><span>j</span></li>
                    <li class="key white" data-key="k"><span>k</span></li>
                    <li class="key black" data-key="o"><span>o</span></li>
                    <li class="key white" data-key="l"><span>l</span></li>
                    <li class="key black" data-key="p"><span>p</span></li>
                    <li class="key white" data-key=";"><span>;</span></li>
                </ul>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.37/Tone.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/audiokeys@0.1.1/dist/audiokeys.min.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/vue/2.1.10/vue.min.js'></script>
    <script src="src/js/knob.js"></script>
    <script>

        //--------------#drag & drop----------------------------
        selectBoxes = document.querySelectorAll(".ENV-select-box");

        let selectedDragItem = null;
        let i = 0;
        selectBoxes.forEach(box => {
            box.setAttribute('data-envnum', i++);

            const img = new Image();
            img.src = "src/images/drag-image.png";

            box.addEventListener("dragstart", function (e) {
                e.dataTransfer.setDragImage(img, 25, 10);
                selectedDragItem = Number(box.dataset.envnum);
            }, false);
        });


        //-------------------#add wavetable images #images #wavetable------------------
        const createOSC = (checkBox, selectionBody, canvasBody, type) => {
            return {
                type: type,
                onOff: true,
                checkBox: document.getElementById(checkBox),
                body: document.getElementById(selectionBody),
                canvas: document.getElementById(canvasBody),
                waveform: null,
                oscillator: new Tone.Oscillator({
                    type: "sine",
                    frequency: 440
                }),
                volCenter: new Tone.Volume(-12),
                volSide: new Tone.Volume(-12),
                volENV: 3,
            };
        };

        envs = [
            new Tone.Envelope({
                attack: 0.1,
                decay: 0.3,
                sustain: 0.8,
                release: 0.3,
            }),
            new Tone.Envelope(0.5, 0.5, 1, 0.5),
            new Tone.Envelope(0.5, 0.5, 0.5, 0.5,),
            new Tone.Envelope(0, 0, 1, 0),
        ]

        oscA = createOSC('checkbox-osc-A', 'wavetable-selection-A', 'wavetable-canvas-A', 'A');
        oscA["knobs"] = {
            unison: app.knobs[10],
            detune: app.knobs[11],
            blend: app.knobs[12],
            pitch: app.knobs[13],
            volume: app.knobs[14],
        };

        oscB = createOSC('checkbox-osc-B', 'wavetable-selection-B', 'wavetable-canvas-B', 'B');
        oscB["knobs"] = {
            unison: app.knobs[0],
            detune: app.knobs[1],
            blend: app.knobs[2],
            pitch: app.knobs[3],
            volume: app.knobs[4],
        };




        //------------------------------tone-------------------------

        const createENVobject = (osc) => {
            temp = {};
            Object.keys(osc.knobs).forEach(function (k) {
                if (osc.knobs[k].env.target != -1) {
                    temp[k] = new Tone.Envelope({
                        attack: envs[osc.knobs[k].env.target].attack,
                        decay: envs[osc.knobs[k].env.target].decay,
                        sustain: envs[osc.knobs[k].env.target].sustain,
                        release: envs[osc.knobs[k].env.target].release,
                    }).triggerAttack();
                }
            })
            return temp;
        };


        const addOSC = (obj) => {
            unison = obj.osc.knobs["unison"].value.cur;
            detune = obj.osc.knobs["detune"].value.cur;
            pitch = obj.osc.knobs["pitch"].value.cur;

            volumeKnob = obj.osc.knobs["volume"];

            osc = obj.osc;
            if (!osc.checkBox.checked) { return; }

            const oscTEMParray = [];
            let mid1 = Math.round((unison % 2 == 0 ? (unison) : (unison - 1)) / 2);
            let mid2 = Math.round(unison % 2 == 0 ? (unison / 2) : (unison / 2 - 1));


            obj.frequency = obj.frequency * Math.pow(2, pitch / 12);

            start = Tone.immediate() + 0.1;

            target = volumeKnob.env.target != -1 ? volumeKnob.env.target : 3;
            let volENV = new Tone.AmplitudeEnvelope({
                attack: envs[target].attack,
                decay: envs[target].decay,
                sustain: envs[target].sustain,
                release: envs[target].release,
            }).triggerAttack(start);

            for (let i = 0; i < unison; i++) {
                let oscTEMP = new Tone.Oscillator(obj.frequency, osc.oscillator.type);

                if (unison > 1) { oscTEMP.detune.value = i * (detune * 2 / (unison - 1)) - detune; }

                if (mid1 == i || mid2 == i) {
                    oscTEMP.connect(volENV);
                    volENV.connect(obj.osc.volCenter);
                    obj.osc.volCenter.toDestination();
                    oscTEMP.start(start);
                }
                else {
                    oscTEMP.connect(volENV);
                    volENV.connect(obj.osc.volSide);
                    obj.osc.volSide.toDestination();
                    oscTEMP.start(start);
                }

                oscTEMParray.push(oscTEMP);
            }

            activeNoteObj = {
                oscArray: oscTEMParray,
                //start: Tone.immediate(),
                unison: unison,
                frequency: obj.frequency,
                env: createENVobject(osc),
                volENV: volENV
            };

            if (obj.note in obj.activeNote) { obj.activeNote[obj.note].push(activeNoteObj); }
            else { obj.activeNote[obj.note] = [activeNoteObj]; }
        }



        const keySet = () => {
            return {
                toRemove: [],
                toRelease: [],
                activeNote: {},
            }
        };

        keySetA = keySet();
        keySetB = keySet();



        const releaseKey = (keyset) => {
            keyset.toRelease.forEach((note) => {
                e = keyset.activeNote[note][0];
                e.volENV.triggerRelease();
                Object.keys(e.env).forEach(function (k) { e.env[k].triggerRelease(); });
                setTimeout(() => { keyset.toRemove.push(note); }, e.volENV.release*1000);
            });
            keyset.toRelease = [];
        };

        const removeKey = (keyset) => {
            keyset.toRemove.forEach((note) => {
                e = keyset.activeNote[note][0];
                e.oscArray.forEach((oscTEMP) => { oscTEMP.stop(); });
                keyset.activeNote[note].shift();
                if (keyset.activeNote[note].length == 0) { delete keyset.activeNote[note]; }
            });
            keyset.toRemove = [];
        }

        const rotateENV = (knob, envValue, showRotation) => {
            let ratio = knob.value.ratio;
            let v = ((knob.value.cur * ratio) - knob.value.low) / ratio * envValue;
            if (showRotation) { knob.env.rotation = (v / ((knob.value.high - knob.value.low) / ratio)) * 264 - 132; }
            return v;
        }

        const adjustSound = (keyset, osc) => {
            //for each pressed KEY
            Object.keys(keyset.activeNote).forEach(function (note) {
                let showRotation = (note == lastPressed);

                e = keyset.activeNote[note][keyset.activeNote[note].length - 1];

                //let start = e.start; //not used
                let unison = e.unison;

                key = "detune";
                if (key in e.env) {
                    let v = rotateENV(osc.knobs[key], e.env[key].value, showRotation);

                    if (unison > 1) {
                        for (let i = 0; i < unison; i++) {
                            e.oscArray[i][key].value = i * (v * 2 / (unison - 1)) - v;
                        }
                    }
                }

                key = "pitch";
                if (key in e.env) {
                    let v = rotateENV(osc.knobs[key], e.env[key].value, showRotation);

                    frequency = e.frequency * Math.pow(2, v / 12);
                    for (let i = 0; i < unison; i++) {
                        e.oscArray[i].frequency.value = frequency;
                    }
                }

                // key = "blend";
                // if (key in e.env) {
                //     let v = rotateENV(osc.knobs[key], e.env[key].value, showRotation);

                //     let volume = osc.knobs['volume'];
                //     let blend = v;
                //     osc.volCenter.volume.value = 40 * Math.log10(((volume + 80) / 160) * (1 - blend));
                //     osc.volSide.volume.value = 40 * Math.log10(((volume + 80) / 160) * (blend));
                //     console.log('???');
                // }

                // key = "volume";
                // if (key in e.env) {
                //     let v = rotateENV(osc.knobs[key], e.env[key].value, showRotation);
                //     let volume = v;
                //     let blend = osc.knobs['blend'].value.cur;
                //     osc.volCenter.volume.value = 40 * Math.log10(((volume + 80) / 160) * (1 - blend));
                //     osc.volSide.volume.value = 40 * Math.log10(((volume + 80) / 160) * (blend));
                // }

            });
        }

        //-------------------------------update - ENV----------------------------
        Tone.Transport.scheduleRepeat((time) => {

            releaseKey(keySetA);
            //releaseKey(keySetB);

            removeKey(keySetA);
            //removeKey(keySetB);

            adjustSound(keySetA, oscA);
            //adjustSound(keySetB);
        }, "32n");

        Tone.Transport.start();


        lastPressed = null;
        const startOSC = (key) => {
            lastPressed = key.note;

            addOSC({
                osc: oscA,
                activeNote: keySetA.activeNote,
                frequency: key.frequency,
                note: key.note,
            });

            // addOSC({
            //     osc: oscB,
            //     activeNote: keySetB.activeNote,
            //     frequency: key.frequency,
            //     note: key.note,
            // });
        };

        const stopOSC = async (key) => {
            keySetA.toRelease.push(key.note);
            //keySetB.toRelease.push(key.note);
        }



    </script>
    <script src="src/js/keyboard.js"></script>
    <script src="src/js/drawCanvas.js"></script>


</body>

</html>