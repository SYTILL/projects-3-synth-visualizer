<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Envelope Knob Example</title>
    <!-- Include jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Include jQuery Knob -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jQuery-Knob/1.2.13/jquery.knob.min.js"></script>
    <!-- Include Tone.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.30/Tone.min.js"></script>
</head>
<body>
    <h1>Envelope Knob Example</h1>
    <input id="envelope-knob" data-width="150" data-height="150"
           data-fgColor="#FF5722" data-bgColor="#F5F5F5"
           data-thickness=".3" value="0">

    <script>
        // Create an envelope
        const envelope = new Tone.Envelope({
            attack: 0.1,
            decay: 0.2,
            sustain: 0.5,
            release: 1
        }).toDestination();

        // Create the knob using jQuery Knob
        $('#envelope-knob').knob({
            min: 0,
            max: 1,
            step: 0.01,
            change: function(value) {
                // Set envelope's value based on knob position
                envelope.value = value;
            }
        });

        // Monitor the envelope state and update the knob
        Tone.Transport.scheduleRepeat(function(time){
            const currentValue = envelope.getValueAtTime(time);
            $('#envelope-knob').val(currentValue).trigger('change');
        }, "16n"); // Adjust the scheduling interval as needed

        // Start the envelope
        envelope.triggerAttack();

        // Optionally, you might want to initialize the knob with default values
        $('#envelope-knob').val(0).trigger('change');
    </script>
</body>
</html>
